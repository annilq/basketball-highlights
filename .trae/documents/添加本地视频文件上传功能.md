# 添加本地视频文件上传功能

## 1. 前端修改

### 1.1 修改路由文件 `apps/app/routes/(app)/shot-detection.tsx`

- 在表单中添加文件上传输入框
- 修改表单提交逻辑，支持文件上传
- 更新UI，添加文件选择和预览功能

### 1.2 修改API查询文件 `apps/app/lib/queries/shot-detection.ts`

- 更新 `DetectShotsInput` 接口，支持文件上传
- 修改 `useDetectShotsMutation` 钩子，支持发送表单数据
- 更新API调用逻辑，根据输入类型选择不同的请求方式

## 2. 后端修改

### 2.1 修改tRPC路由 `apps/api/routers/shotDetection.ts`

- 更新输入验证，支持文件上传
- 修改处理逻辑，支持直接接收上传的文件
- 确保与Python服务的兼容性

### 2.2 修改HTTP路由配置 `apps/api/lib/app.ts`

- 确保tRPC支持文件上传
- 可能需要添加专门的文件上传处理路由

## 3. 实现细节

### 3.1 前端实现

- 使用 `input[type="file"]` 元素实现文件选择
- 使用 `FormData` API 发送文件数据
- 更新表单处理逻辑，区分URL和文件上传

### 3.2 后端实现

- 确保tRPC支持 `multipart/form-data` 请求
- 修改输入验证，支持文件字段
- 更新处理逻辑，根据输入类型选择不同的处理方式

## 4. 测试策略

- 测试URL输入方式仍然正常工作
- 测试文件上传方式正常工作
- 测试不同大小的视频文件
- 测试与Python服务的集成

## 5. 注意事项

- 确保跨域资源共享（CORS）配置正确
- 处理大文件上传的性能问题
- 确保文件上传的安全性
- 提供良好的错误处理和用户反馈
